<h2><%= @hotel.name %></h2>
<% if current_hotel == @hotel %>
  <%= link_to "Edit Hotel", edit_hotel_registration_path %>
<% end %>
<p><%= @hotel.description %></p>
<p>Meeting rooms: <%= @hotel.facilities.count %></p>
<h6>Capacity Range</h6>
<p>Up to <%= @max %> </p>
<h6>Location</h6>
<%= @hotel.city %>,<%= @hotel.county %>, <%= @hotel.country %>

<!-- Google Maps -->
    <style>
       #map {
        height: 400px;
        width: 100%;
       }
    </style>
    <h3>My Google Maps Demo</h3>
    <div id="map"></div>
    <script>

      function initMap() {
        var hotel = {lat: <%= @hotel.latitude %>, lng: <%= @hotel.longitude %>}
        var map = new google.maps.Map(document.getElementById('map'), {
          zoom: 15,
          center: hotel
        });

        // Create an array of alphabetical characters used to label the markers.
        var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

        // Add some markers to the map.
        // Note: The code uses the JavaScript Array.prototype.map() method to
        // create an array of markers based on a given "locations" array.
        // The map() method here has nothing to do with the Google Maps API.
        var markers = locations.map(function(location, i) {
          return new google.maps.Marker({
            position: location,
            label: labels[i % labels.length]
          });
        });

        // Add a marker clusterer to manage the markers.
        var markerCluster = new MarkerClusterer(map, markers,
            {imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'});
      }
      var locations = []
      <% Hotel.all.each do |hotel| %>
        locations.push({lat: <%= hotel.latitude %>, lng: <%= hotel.longitude %>})
      <% end %>
    </script>
    <script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
       </script>
       <script async defer
       src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDOFFKgy9_R0ZwtK52sOfAzmEPHiy18bcE&callback=initMap">
       </script>

<table class="table">
  <th>
    <tr>
      <td><h6>Meeting Rooms</h6></td>
      <td>m2</td>
      <td>LxWxH </br> [m]</td>
      <td>U-Shape</td>
      <td>Classroom</td>
      <td>Theatre</td>
      <td>Round Table</td>
      <td>Board Room</td>
      <td>Cocktail</td>
    </tr>
  </th>
  <tbody>
    <% @facilities.each do |facility| %>
    <tr>
      <td><%= link_to facility.name, facility_path(facility) %></td>
      <td></td>
      <td></td>
        <td>
          <% if facility.facility_layouts.include? "U-Shape" %>
          <% facility.facility_layouts.split(" ").length.times do |i| %>
            <% if facility.facility_layouts.split(" ")[i] == "U-Shape" %>
              <%= facility.capacity.split(" ")[i] %>
            <% end %>
          <% end %>
          <% else %>
            -
          <% end %>
        </td>
        <td>
          <% if facility.facility_layouts.include? "Classroom" %>
          <% facility.facility_layouts.split(" ").length.times do |i| %>
            <% if facility.facility_layouts.split(" ")[i] == "Classroom" %>
              <%= facility.capacity.split(" ")[i] %>
            <% end %>
          <% end %>
          <% else %>
            -
          <% end %>
        </td>
        <td>
          <% if facility.facility_layouts.include? "Theatre" %>
            <% facility.facility_layouts.split(" ").length.times do |i| %>
              <% if facility.facility_layouts.split(" ")[i] == "Theatre" %>
                <%= facility.capacity.split(" ")[i] %>
              <% end %>
            <% end %>
          <% else %>
            -
          <% end %>
        </td>
        <td>
          <% if facility.facility_layouts.include? "Round Table" %>
          <% facility.facility_layouts.split(" ").length.times do |i| %>
            <% if facility.facility_layouts.split(" ")[i] == "Round Table" %>
              <%= facility.capacity.split(" ")[i] %>
            <% end %>
          <% end %>
          <% else %>
            -
          <% end %>
        </td>
        <td>
          <% if facility.facility_layouts.include? "Board Room" %>
          <% facility.facility_layouts.split(" ").length.times do |i| %>
            <% if facility.facility_layouts.split(" ")[i] == "Boardroom" %>
              <%= facility.capacity.split(" ")[i] %>
            <% end %>
          <% end %>
          <% else %>
            -
          <% end %>
        </td>
        <td>
          <% if facility.facility_layouts.include? "Cocktail" %>
          <% facility.facility_layouts.split(" ").length.times do |i| %>
            <% if facility.facility_layouts.split(" ")[i] == "Cocktail" %>
              <%= facility.capacity.split(" ")[i] %>
            <% end %>
          <% end %>
          <% else %>
            -
          <% end %>
        </td>
    </tr>
    <% end %>
   </tbody>
</table>

<h2>My Listings</h2>
<div class="row clearleft-custom">
  <% @hotel.facilities.each do |facility| %>
    <div class="col-xs-12 col-sm-6 col-md-4">
      <div class="thumbnail"><a href="/facilities/<%= facility.id %>" class="img-link card-image"><%= image_tag Photo.find(facility.photos.ids.sample).image.url, size: "370x250" %><span class="thumbnail-price"><%= number_to_currency(facility.price, :unit => "Kes") %>/<span class="mon">day</span></span></a>
        <div class="caption">
          <h4><a href="/facilities/<%= facility.id %>"><%= facility.name %> in <%= link_to facility.hotel.name, hotel_path(facility.hotel) %></a></h4>
          <% i = 0 %>
            <% facility.facility_layouts.split(" ").length.times do |orientation| %>
              <div class="col-md-6" style="font-size: 15px;">
                <span class="icon icon-sm icon-darker hotel-icon-10"></span><%= facility.facility_layouts.split(" ")[i] %> - <%= facility.capacity.split(" ")[i] %>
              </div>
              <% i += 1 %>
            <% end %></br>
          <p><%= facility.description %></p>
        </div>
      </div>
    </div>
  <% end %>
</div>
